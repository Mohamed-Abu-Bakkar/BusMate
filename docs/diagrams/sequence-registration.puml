@startuml Registration-Sequence
title Registration Flow (validate -> send -> register)

actor Visitor
participant "UI /auth/register" as UI
participant "API /api/register/send" as APISend
participant "API /api/register" as APIRegister
database "DB (Postgres)" as DB

Visitor -> UI: Fill email, rollNo
UI -> APISend: POST { email, rollNo }
APISend -> DB: SELECT users WHERE email OR rollNo
DB --> APISend: [] or existing
APISend --> UI: 200 OK or 409 Conflict
Visitor -> UI: Fill remaining fields + OTP
UI -> APIRegister: POST registrationSchema
APIRegister -> DB: SELECT users WHERE email
APIRegister -> DB: SELECT users WHERE rollNo
APIRegister -> UI: 400 if otp != SentOTP
APIRegister -> DB: INSERT user
APIRegister -> DB: INSERT account(password)
APIRegister --> UI: 201 Created { user }

@enduml
